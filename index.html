<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="apple-touch-icon" href="launch.png">
  <link rel="apple-touch-startup-image" href="launch.png">
  <meta name="apple-mobile-web-app-title" content="Korero">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>

<body>
  <audio id="steam" src="steam.mp3"></audio>
  <audio id="seagull" src="seagull.mp3"></audio>
  <audio id="Cats" src="Cats.mp3"></audio>
  <audio id="Chickens" src="Chickens.mp3"></audio>

  <button id="start" class="button">start</button><br>


  <button id="ee" class="button">steam engine</button><br>
  <button id="oo" class="button">seagull</button><br>
  <input type="range" min="0" max="2" value="1" step="0.1" id="steamGainNodeSlider">
  <br>
  <input type="range" min="-1" max="+1" value="0" step="0.1" id="steamPannerNodeSlider1">
  <input type="range" min="-1" max="1" value="0" step="0.1" id="steamPannerNodeSlider1">


  <script>
    var audioCtx;
    var tracks;

    start = () => {
        audioCtx = new AudioContext || window.webkitAudioContext;


        steamSound = new Sound("steam");
        seagullSound = new Sound("seagull");
        CatsSound = new Sound("Cats");
        ChickensSound = new Sound("Chickens");

        tracks = [
          new Track(1, CatsSound, 1),
          new Track(6, ChickensSound, 1),
          //  new Track(6, steamSound, 1),
          //  new Track(10, seagullSound, 2)
        ]

        /*  for (t of tracks) {
            setTimeout(function() {
              t.soundName.play();
              console.log(t.time + "  " + t.soundName.fileName);
            }, t.time * 1000);
          }
        }
        */

        setTimeout(function() {
          tracks[0].soundName.play();
          console.log(tracks[0].time + "  " + tracks[0].soundName.fileName);
        }, tracks[0].time * 1000);

        setTimeout(function() {
          tracks[1].soundName.play();
          console.log(tracks[1].time + "  " + tracks[1].soundName.fileName);
        }, tracks[1].time * 1000);

      }

        class Sound {
          constructor(soundName) {
            this.soundName = soundName;
            this.fileName = this.soundName + ".mp3";
            this.audioElement = document.getElementById(soundName);
            this.track = audioCtx.createMediaElementSource(this.audioElement);
            this.gainNode = audioCtx.createGain();
            this.panner = audioCtx.createStereoPanner();
          }

          play(time) {
            this.track.connect(this.gainNode).connect(this.panner).connect(audioCtx.destination);
            this.audioElement.play();
          }
        }

        class Track {
          constructor(time, soundName, panValue) {
            this.time = time;
            this.soundName = soundName;
            this.panValue = panValue;
          }
        }



        /*    steamGainNodeSlider = document.getElementById("steamGainNodeSlider");
            steamPannerNodeSlider = document.getElementById("steamPannerNodeSlider1");



            playSound = (sound) => {
              sound.play();
            }
        */
        document.getElementById("start").addEventListener("click", () => {
          start();
        });
        /*
            document.getElementById("ee").addEventListener("click", () => {
              playSound(steamSound);
            });

            document.getElementById("oo").addEventListener("click", () => {
              playSound(seagullSound);
            });

            steamGainNodeSlider.oninput = function() {
              steamGainNode.gain.value = this.value;
            }
            steamPannerNodeSlider.oninput = function() {
              steamPanner.pan.value = steamPannerNodeSlider.value;
            }

            */
  </script>

  v41
</body>

</html>
